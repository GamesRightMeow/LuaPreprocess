<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta content="width=device-width, initial-scale=1" name="viewport">
		<meta content="LuaWebGen 1.5.0" name="generator">

		<meta content="Official website for LuaPreprocess - the small and straightforward Lua preprocessor with simple syntax." name="description">

		<meta content="website" name="og:type">
		<meta content="Extra functionality - Documentation - LuaPreprocess" name="og:title">
		<meta content="Official website for LuaPreprocess - the small and straightforward Lua preprocessor with simple syntax." name="og:description">

		<meta content="http://refreezed.com/luapreprocess/logo.png" name="og:image">

		<meta content="http://refreezed.com/luapreprocess/docs/extra-functionality/" name="og:url">
		<meta content="en_US" name="og:locale">
		<meta content="LuaPreprocess" name="og:site_name">

		<title>Extra functionality - Documentation - LuaPreprocess</title>

		<link href="http://refreezed.com/luapreprocess/docs/extra-functionality/" rel="canonical">
		<link href="/style.css" rel="stylesheet">
		<link href="/luapreprocess/favicon.ico" rel="shortcut icon" type="image/x-icon">

		<script src="/main.js"></script>
	</head>

	<body data-site="luapreprocess">
		<header>

				<div id="home">
					<a href="/">« ReFreezed.com</a>
				</div>

			<a class="siteFront" href="/luapreprocess/"><img alt="LuaPreprocess" class="limitSize" height="126" src="/luapreprocess/logo.png" width="600"></a>
		</header>

		<nav id="main-navigation">

				<ul>

							<li><a href="/luapreprocess/">About</a></li>

							<li><a href="https://github.com/ReFreezed/LuaPreprocess/releases/latest">Download</a></li>

							<li><a href="/luapreprocess/docs/"><strong>Documentation</strong></a></li>

							<li><a href="/luapreprocess/highlight/">Highlighter</a></li>

							<li><a href="https://github.com/ReFreezed/LuaPreprocess/issues">Issue Tracker</a></li>

							<li><a href="https://github.com/ReFreezed/LuaPreprocess">Source</a></li>

				</ul>

		</nav>

		<div class="middleOuter"><div class="middleInner">

	<nav id="sidebar"><div>
		<input id="hideTopics" role="button" style="display:none;" type="checkbox">
		<script>{
			let checkbox     = document.getElementById("hideTopics");
			checkbox.checked = (localStorageGet("docs_topicsHidden") === "1");

			checkbox.addEventListener("change", function(e) {
				if (checkbox.checked)  localStorageSet("docs_topicsHidden", "1");
				else                   localStorageRemove("docs_topicsHidden");
			});
		}</script>

		<div class="title">
			<h1>Topics</h1>
			<span class="hideTopics"><label for="hideTopics"></label></span>
		</div>

		<ul class="topics">
			<li><a href="/luapreprocess/docs/">Home</a><ul><li><a href="/luapreprocess/docs/#how-to-metaprogram">How to metaprogram</a></li><li><a href="/luapreprocess/docs/#two-ways-of-generating-code">Two ways of generating code</a></li><li><a href="/luapreprocess/docs/#potential-gotchas">Potential gotchas</a></li></ul></li><li><a href="/luapreprocess/docs/api/">API</a></li><li><a href="/luapreprocess/docs/command-line/">Command line</a><ul><li><a href="/luapreprocess/docs/command-line/#command-line-usage">Command line usage</a></li><li><a href="/luapreprocess/docs/command-line/#options">Options</a></li><li><a href="/luapreprocess/docs/command-line/#message-handlers">Message handlers</a></li><li><a href="/luapreprocess/docs/command-line/#messages">Messages</a></li><li><a href="/luapreprocess/docs/command-line/#other-info">Other info</a></li></ul></li><li><strong>Extra functionality</strong><ul><li><a href="/luapreprocess/docs/extra-functionality/#preprocessor-keywords">Preprocessor keywords</a></li><li><a href="/luapreprocess/docs/extra-functionality/#preprocessor-symbols">Preprocessor symbols</a></li><li><a href="/luapreprocess/docs/extra-functionality/#backtick-strings">Backtick strings</a></li></ul></li>
		</ul>
	</div></nav>

<main>

		<h1>Extra functionality</h1>

	<ul>
<li><a href="#preprocessor-keywords">Preprocessor keywords</a></li>
<li><a href="#preprocessor-symbols">Preprocessor symbols</a></li>
<li><a href="#backtick-strings">Backtick strings</a></li>
</ul>
<hr>
<h2 id="preprocessor-keywords">Preprocessor keywords<a aria-hidden="true" class="anchor" href="#preprocessor-keywords"><svg height="16" viewBox="0 0 16 16" width="16"><path d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z" fill-rule="evenodd"/></svg></a></h2>
<p>In addition to the exclamation mark (<code>!</code>) there is another symbol with special meaning in LuaPreprocess: the at sign (<code>@</code>).
It&apos;s used as prefix for a few special preprocessor keywords that do different things.</p>
<ul>
<li><a href="#file">@file</a></li>
<li><a href="#line">@line</a></li>
<li><a href="#insert">@insert</a><ul>
<li><a href="#insert-name">@insert &quot;name&quot;</a></li>
<li><a href="#insert-func">@insert func()</a> <em>(macros)</em></li>
</ul>
</li>
</ul>
<h3 id="file">@file<a aria-hidden="true" class="anchor" href="#file"><svg height="16" viewBox="0 0 16 16" width="16"><path d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z" fill-rule="evenodd"/></svg></a></h3>
<p><small class="tag tag-version" title="Added in version 1.11">v1.11</small>
Inserts the path to the current file as a string literal, e.g. <code>&quot;src/scenes/main.lua2p&quot;</code>.</p>
<pre class="syntax-lua"><code>print(<span class="s">&quot;Current file: &quot;</span>..<span class="k">@file</span>)

<span class="c">-- Example output:
</span>print(<span class="s">&quot;Current file: &quot;</span>..<span class="s">&quot;src/scenes/main.lua2p&quot;</span>)
</code></pre>
<h3 id="line">@line<a aria-hidden="true" class="anchor" href="#line"><svg height="16" viewBox="0 0 16 16" width="16"><path d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z" fill-rule="evenodd"/></svg></a></h3>
<p><small class="tag tag-version" title="Added in version 1.11">v1.11</small>
Inserts the current line number as an integer numeral.</p>
<pre class="syntax-lua"><code>print(<span class="s">&quot;Current line: &quot;</span>..<span class="k">@line</span>)

<span class="c">-- Example output:
</span>print(<span class="s">&quot;Current line: &quot;</span>.. <span class="n">372</span>)
</code></pre>
<h3 id="insert">@insert<a aria-hidden="true" class="anchor" href="#insert"><svg height="16" viewBox="0 0 16 16" width="16"><path d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z" fill-rule="evenodd"/></svg></a></h3>
<p>This keyword has two variants.</p>
<h4 id="insert-name">@insert &quot;name&quot;<a aria-hidden="true" class="anchor" href="#insert-name"><svg height="16" viewBox="0 0 16 16" width="16"><path d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z" fill-rule="evenodd"/></svg></a></h4>
<p><small class="tag tag-version" title="Added in version 1.10">v1.10</small>
This variant inserts a <em>resource</em> as-is in-place before the metaprogram runs (the resource being a Lua code string from somewhere).
By default, <code>name</code> is a path to a file to be inserted but this behavior can be changed by defining <code>params.onInsert()</code>
when calling <a href="/luapreprocess/docs/api/#processfile"><code>processFile</code></a> or <a href="/luapreprocess/docs/api/#processstring"><code>processString</code></a>
(or by handling the <a href="/luapreprocess/docs/command-line/#insert"><code>&quot;insert&quot;</code></a> message in the message handler in the command line program).</p>
<pre class="syntax-lua"><code><span class="c">-- script.lua
</span><span class="k">local</span> one = <span class="n">1</span>
<span class="k">@insert</span> <span class="s">&quot;partialScript.lua&quot;</span>
print(one + two)

<span class="c">-- partialScript.lua
</span><span class="k">local</span> two = <span class="p"><span class="d">!</span>( <span class="n">1</span>+<span class="n">1</span> )</span>

<span class="c">-- Output:
</span><span class="k">local</span> one = <span class="n">1</span>
<span class="k">local</span> two = <span class="n">2</span>
print(one + two)
</code></pre>
<p>The keyword can also appear in the metaprogram anywhere.</p>
<pre class="syntax-lua"><code><span class="c">-- script.lua
</span><span class="p"><span class="d">!</span>(
<span class="k">@insert</span> <span class="s">&quot;yellFunction.lua&quot;</span>
yell(<span class="s">&quot;aaargh&quot;</span>)
)</span>
<span class="k">local</span> versionText = <span class="p"><span class="d">!</span>( <span class="s">&quot;Version: &quot;</span> .. <span class="k">@insert</span> <span class="s">&quot;appVersion.txt&quot;</span> )</span>
print(versionText) <span class="c">-- Version: 1.2.3
</span>
<span class="c">-- yellFunction.lua
</span><span class="k">local</span> <span class="k">function</span> yell(text)
	print(text:upper()..<span class="s">&quot;!!!&quot;</span>)
<span class="k">end</span>

<span class="c">-- appVersion.txt
</span><span class="s">&quot;1.2.3&quot;</span>
</code></pre>
<p><small class="tag tag-version" title="Added in version 1.13">v1.13</small>
<code>@insert</code> can also be written more compactly as <code>@@</code>:</p>
<pre class="syntax-lua"><code><span class="k">@@</span><span class="s">&quot;yellFunction.lua&quot;</span>
</code></pre>
<h4 id="insert-func">@insert func()<a aria-hidden="true" class="anchor" href="#insert-func"><svg height="16" viewBox="0 0 16 16" width="16"><path d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z" fill-rule="evenodd"/></svg></a></h4>
<p><small class="tag tag-version" title="Added in version 1.13">v1.13</small>
This variant outputs the result returned from a function <code>func()</code> defined in the metaprogram (like <code>!!(func())</code>)
except all arguments are converted to individual strings containing the apparent Lua code before the call.
We call these macros (similar to macros in C/C++ and other languages).</p>
<pre class="syntax-lua"><code><span class="c">-- Define a better assert function.
</span>
<span class="p"><span class="d">!</span>(
<span class="k">local</span> DEBUG = <span class="n">true</span>

<span class="k">local</span> <span class="k">function</span> ASSERT(conditionCode, messageCode)
	<span class="k">if</span> <span class="l">not</span> DEBUG <span class="k">then</span>
		<span class="c">-- Make ASSERT() calls do nothing if we&apos;re not in debug mode.
</span>		<span class="k">return</span> <span class="s">&quot;&quot;</span>
	<span class="k">end</span>
	<span class="k">if</span> <span class="l">not</span> messageCode <span class="k">then</span>
		messageCode = string.format(<span class="s">&quot;</span><span class="n">%q</span><span class="s">&quot;</span>, <span class="s">&quot;Assertion failed: &quot;</span>..conditionCode)
	<span class="k">end</span>
	<span class="k">return</span> <span class="s">&quot;if not (&quot;</span>..conditionCode..<span class="s">&quot;) then error(&quot;</span>..messageCode..<span class="s">&quot;) end&quot;</span>
<span class="k">end</span>
)</span>

<span class="k">local</span> text = <span class="s">&quot;Herzlich willkommen!&quot;</span>
<span class="k">@insert</span> <span class="p">ASSERT</span>(#text &lt; <span class="n">15</span>, <span class="s">&quot;Text is too long: &quot;</span>..text)

<span class="c">-- Output:
</span><span class="k">local</span> text = <span class="s">&quot;Herzlich willkommen!&quot;</span>
<span class="k">if</span> <span class="l">not</span> (#text &lt; <span class="n">15</span>) <span class="k">then</span> error(<span class="s">&quot;Text is too long: &quot;</span>..text) <span class="k">end</span>
</code></pre>
<blockquote>
<p>Note: An <a href="/luapreprocess/docs/api/#assert"><code>ASSERT</code></a> macro is already provided by the library.</p>
</blockquote>
<p><code>@insert</code> can also be written more compactly as <code>@@</code>:</p>
<pre class="syntax-lua"><code><span class="k">@@</span><span class="p">ASSERT</span>(#text &lt; <span class="n">15</span>, <span class="s">&quot;Text is too long: &quot;</span>..text)
</code></pre>
<blockquote>
<p><code>@@ASSERT</code> kind of looks like a preprocessor keyword here, so we could call it a user-defined preprocessor keyword if we wanted to (even though it&apos;s not actually a keyword).</p>
</blockquote>
<p><small class="tag tag-version" title="Added in version 1.14">v1.14</small>
<code>!(expression)</code> and <code>!!(expression)</code> work in macros.
Note that code blocks in macros do not output anything themselves - instead, their result is concatenated with the surrounding Lua code to be part of the argument for the macro function.</p>
<p>Macros can also be nested.</p>
<pre class="syntax-lua"><code><span class="p"><span class="d">!</span><span class="k">local</span> variableName = <span class="s">&quot;text&quot;</span></span>
<span class="p"><span class="d">!</span><span class="k">local</span> maxLength    = <span class="n">3</span>*<span class="n">5</span></span>

<span class="k">@@</span><span class="p">ASSERT</span>(
	#<span class="p"><span class="d">!!</span>(variableName)</span> &lt; <span class="p"><span class="d">!</span>(maxLength)</span>,
	<span class="k">@@</span><span class="p">string.upper</span>(<span class="s">&quot;Text is too long: &quot;</span>) .. <span class="p"><span class="d">!!</span>(variableName)</span>
)

<span class="c">-- Output:
</span><span class="k">local</span> text = <span class="s">&quot;Herzlich willkommen!&quot;</span>
<span class="k">if</span> <span class="l">not</span> (#text &lt; <span class="n">15</span>) <span class="k">then</span> error(<span class="s">&quot;TEXT IS TOO LONG: &quot;</span> .. text) <span class="k">end</span>
</code></pre>
<p>Note that <code>string.upper</code> receives <code>&quot;\&quot;Text is too long: \&quot;&quot;</code> here, i.e. a Lua code string,
but it works because the function doesn&apos;t change the quote characters.</p>
<p>These are all the forms macros can have:</p>
<pre class="syntax-lua"><code><span class="k">@@</span><span class="p">func</span>()    <span class="c">-- Syntax sugar for @insert func()
</span><span class="k">@@</span><span class="p">func</span>{}    <span class="c">-- Syntax sugar for @@func({})
</span><span class="k">@@</span><span class="p">func</span><span class="s">&quot;&quot;</span>    <span class="c">-- Syntax sugar for @@func(&quot;&quot;)
</span><span class="k">@@</span><span class="p">func</span><span class="p"><span class="d">!</span>(e)</span>  <span class="c">-- Syntax sugar for @@func(!(e))
</span><span class="k">@@</span><span class="p">func</span><span class="p"><span class="d">!!</span>(e)</span> <span class="c">-- Syntax sugar for @@func(!!(e)) - this is functionally the same as !!(func(e))
</span></code></pre>
<p><small class="tag tag-version" title="Added in version 1.16">v1.16</small>
Macro functions can choose whether to return a Lua code string or use <a href="/luapreprocess/docs/api/#outputlua"><code>outputLua</code></a> (and related functions).</p>
<pre class="syntax-lua"><code><span class="p"><span class="d">!</span>(
<span class="k">local</span> <span class="k">function</span> DOG_1()
	<span class="k">return</span> <span class="s">&quot;getDog()&quot;</span>
<span class="k">end</span>
<span class="k">local</span> <span class="k">function</span> DOG_2()
	outputLua(<span class="s">&quot;getDog()&quot;</span>)
<span class="k">end</span>
)</span>
<span class="c">-- The result for these two lines are the same:
</span><span class="k">local</span> dog = <span class="k">@@</span><span class="p">DOG_1</span>()
<span class="k">local</span> dog = <span class="k">@@</span><span class="p">DOG_2</span>()

<span class="c">-- Output:
</span><span class="k">local</span> dog = getDog()
<span class="k">local</span> dog = getDog()
</code></pre>
<pre class="syntax-lua"><code><span class="c">-- Combining both methods raises an error.
</span><span class="p"><span class="d">!</span>(
<span class="k">local</span> <span class="k">function</span> DOG_3()
	outputLua(<span class="s">&quot;getDog()&quot;</span>)
	<span class="k">return</span> <span class="s">&quot;getDog()&quot;</span>
<span class="k">end</span>
)</span>
<span class="k">local</span> dog = <span class="k">@@</span><span class="p">DOG_3</span>() <span class="c">-- Error!
</span></code></pre>
<p><small class="tag tag-version" title="Added in version 1.19">v1.19</small>
Any other use of <code>!</code> also works in macros.</p>
<pre class="syntax-lua"><code><span class="p"><span class="d">!</span>(
<span class="k">local</span> <span class="k">function</span> ONE_TWO_ONE(one, two)
	<span class="k">return</span> one .. two .. one
<span class="k">end</span>
)</span>
<span class="k">@@</span><span class="p">ONE_TWO_ONE</span>(
	<span class="p"><span class="d">!</span>outputLua(<span class="s">&quot;bark()&quot;</span>) <span class="c">-- The output is captured by the macro&apos;s 1st argument.
</span></span>	,
	<span class="p"><span class="d">!</span>outputLua(<span class="s">&quot;meow()&quot;</span>) <span class="c">-- The output is captured by the macro&apos;s 2nd argument.
</span></span>)

<span class="c">-- Output:
</span>bark()
meow()
bark()
</code></pre>
<div class="paragraph seeAlso">See also: <a href="/luapreprocess/docs/api/#callmacro">callMacro</a></div>
<h2 id="preprocessor-symbols">Preprocessor symbols<a aria-hidden="true" class="anchor" href="#preprocessor-symbols"><svg height="16" viewBox="0 0 16 16" width="16"><path d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z" fill-rule="evenodd"/></svg></a></h2>
<p><small class="tag tag-version" title="Added in version 1.16">v1.16</small>
Preprocessor symbols output Lua code similarly to <code>!!(expression)</code>.
A symbol is a dollar sign (<code>$</code>) followed by a name referencing a variable in the metaprogram.</p>
<pre class="syntax-lua"><code><span class="p"><span class="d">!</span><span class="k">local</span> EXPRESSION = <span class="s">&quot;5*getFoo()&quot;</span></span>
<span class="c">-- These two lines are equivalent:
</span><span class="k">local</span> x = <span class="p">$EXPRESSION</span>
<span class="k">local</span> x = <span class="p"><span class="d">!!</span>(EXPRESSION)</span>

<span class="c">-- Output:
</span><span class="k">local</span> x = <span class="n">5</span>*getFoo()
<span class="k">local</span> x = <span class="n">5</span>*getFoo()
</code></pre>
<p>A difference from <code>!!(expression)</code> is that if the name references a function (<small class="tag tag-version" title="Added in version 1.18">v1.18</small> or callable table) then the function (or table) is called.</p>
<pre class="syntax-lua"><code><span class="p"><span class="d">!</span>(
<span class="k">local</span> count = <span class="n">0</span>
<span class="k">local</span> <span class="k">function</span> NEW_ID()
	count = count + <span class="n">1</span>
	<span class="k">return</span> toLua(count)
<span class="k">end</span>
)</span>
<span class="k">local</span> someId  = <span class="p">$NEW_ID</span>
<span class="k">local</span> otherId = <span class="p">$NEW_ID</span>

<span class="c">-- Output:
</span><span class="k">local</span> someId  = <span class="n">1</span>
<span class="k">local</span> otherId = <span class="n">2</span>
</code></pre>
<p>Preprocessor symbols and macros can work very well together.</p>
<pre class="syntax-lua"><code><span class="p"><span class="d">!</span><span class="k">local</span> <span class="k">function</span> ADD_IF_SINGLE_DIGIT(variable, value)</span>
	<span class="k">if</span> <span class="p">$variable</span> &lt;= <span class="n">9</span> <span class="k">then</span>
		<span class="p">$variable</span> = <span class="p">$variable</span> + <span class="p">$value</span>
	<span class="k">end</span>
<span class="p"><span class="d">!</span><span class="k">end</span></span>

<span class="k">local</span> x = <span class="n">0</span>
<span class="k">@@</span><span class="p">ADD_IF_SINGLE_DIGIT</span>(x, <span class="n">100</span>)

<span class="c">-- Output:
</span><span class="k">local</span> x = <span class="n">0</span>
<span class="k">if</span> x &lt;= <span class="n">9</span> <span class="k">then</span>
	x = x + <span class="n">100</span>
<span class="k">end</span>
</code></pre>
<p>Note how the body of the <code>ADD_IF_SINGLE_DIGIT</code> function is not part of the metaprogram (except for the <code>$variable</code> and <code>$value</code> symbols).
We could write the same function like this:</p>
<pre class="syntax-lua"><code><span class="p"><span class="d">!</span>(
<span class="k">local</span> <span class="k">function</span> ADD_IF_SINGLE_DIGIT(variable, value)
	outputLua(<span class="s">&quot;if &quot;</span>,variable,<span class="s">&quot; &lt;= 9 then</span><span class="n">\n</span><span class="s">&quot;</span>)
	outputLua(<span class="s">&quot;</span><span class="n">\t</span><span class="s">&quot;</span>,variable,<span class="s">&quot; = &quot;</span>,variable,<span class="s">&quot; + &quot;</span>,value,<span class="s">&quot;</span><span class="n">\n</span><span class="s">&quot;</span>)
	outputLua(<span class="s">&quot;end</span><span class="n">\n</span><span class="s">&quot;</span>)
<span class="k">end</span>
)</span>
</code></pre>
<h2 id="backtick-strings">Backtick strings<a aria-hidden="true" class="anchor" href="#backtick-strings"><svg height="16" viewBox="0 0 16 16" width="16"><path d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z" fill-rule="evenodd"/></svg></a></h2>
<p>The <a href="/luapreprocess/docs/api/#processfile"><code>backtickStrings</code> parameter</a> (or <a href="/luapreprocess/docs/command-line/#backtickstrings"><code>--backtickstrings</code> option</a>) enables the backtick (<code>`</code>) to be used as string literal delimiters.
Backtick strings don&apos;t interpret any escape sequences and can&apos;t contain other backticks.
The strings can span multiple lines.</p>
<p>This feature can be nice for strings that contain Lua code and you want your text editor to apply normal syntax highlighting to the string contents.
Example:</p>
<pre class="syntax-lua"><code><span class="p"><span class="d">!</span><span class="k">local</span> DOUBLE_X = <span class="s">`</span>
	x = x*<span class="n">2</span>
<span class="s">`</span></span>
<span class="k">local</span> x = <span class="n">1</span>
<span class="p">$DOUBLE_X</span>
<span class="p">$DOUBLE_X</span>
print(x)

<span class="c">-- Output:
</span><span class="k">local</span> x = <span class="n">1</span>
x = x*<span class="n">2</span>
x = x*<span class="n">2</span>
print(x)
</code></pre>

	<p style="margin-top: 4rem;">
		<small>Page updated: 2022-07-08</small>
	</p>
</main>

		</div></div>

		<footer>Copyright © 2009-2022 <a href="http://marcus.refreezed.com/">Marcus &apos;ReFreezed&apos; Thunström</a></footer>
	</body>
</html>